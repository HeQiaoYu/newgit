function getIEVersion(){for(var e=3,a=document.createElement("b"),t=a.all||[];a.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i><![endif]--\x3e",t[0];);return e>4?e:document.documentMode}function getCurrentScript(){if(document.currentScript)return document.currentScript.src;var e;try{a.b.c()}catch(a){e=a.stack,!e&&window.opera&&(e=(String(a).match(/of linked script \S+/g)||[]).join(" "))}if(e)return e=e.split(/[@ ]/g).pop(),e="("===e[0]?e.slice(1,-1):e,e.replace(/(:\d+)?:\d+$/i,"");for(var t,i=document.getElementsByTagName("script"),n=0;t=i[n++];)if("interactive"===t.readyState)return t.className=t.src}function bindEvent(e){window.addEventListener?e.element.addEventListener(e.type,function(a){e.callBack(a)},!1):e.element.attachEvent("on"+e.type,function(a){e.callBack(a||window.event)})}function alertMsg(){window.zhiqiuTimer=setTimeout(function(){window.zhiqiuCount%2==0?document.getElementById("zhiqiu-icon-mark").style.visibility="visible":document.getElementById("zhiqiu-icon-mark").style.visibility="hidden",window.zhiqiuCount++,alertMsg()},800)}function clearAlertMsg(){clearTimeout(window.zhiqiuTimer),window.zhiqiuCount=0,document.getElementById("zhiqiu-icon-mark").style.visibility="visible"}var ieVersion=getIEVersion(),zhiqiu_support=!ieVersion||ieVersion>7,curPath=getCurrentScript(),zhiqiu_CurrentDir=curPath.substr(0,curPath.indexOf("/chat/"))+"/chat/",basePath=curPath.substr(0,curPath.indexOf("/chat/"))+"/",zhiqiu_CssLink=zhiqiu_CurrentDir+"css/shell.min.css",head=document.getElementsByTagName("head")[0],cssURL=zhiqiu_CssLink,linkTag=document.createElement("link");linkTag.id="zhiqiu-style",linkTag.href=cssURL,linkTag.setAttribute("rel","stylesheet"),linkTag.setAttribute("type","text/css"),head.appendChild(linkTag);var bodyTag=document.getElementsByTagName("body")[0],wrapperTag=document.createElement("div");wrapperTag.id="zhiqiu_chat_wrapper",wrapperTag.style.display="none";var iframeTag=document.createElement("iframe");iframeTag.setAttribute("frameborder","0"),iframeTag.setAttribute("border","0");var iframeStyleTag=document.createElement("iframe"),loadingWrapper=document.createElement("div");loadingWrapper.className="loading-wrapper";var loadingMark=document.createElement("span");loadingMark.className="loading-mark",loadingWrapper.appendChild(loadingMark),loadingWrapper.style.display="none";var index=curPath.indexOf("?"),search=curPath.substring(index);iframeStyleTag.src=zhiqiu_CurrentDir+"html/pluginstyle.html"+search+"&rnd="+Math.ceil(1e3*Math.random()),iframeStyleTag.style.display="none",iframeTag.onload=function(){},wrapperTag.appendChild(iframeTag),zhiqiu_support&&(wrapperTag.appendChild(iframeStyleTag),wrapperTag.appendChild(loadingWrapper)),bodyTag.appendChild(wrapperTag);var markTag=document.createElement("div");markTag.style.display="none";var iconTag=document.createElement("span"),textTag=document.createElement("span");markTag.className="mark-zhiqiu",iconTag.className="icon-mark",iconTag.id="zhiqiu-icon-mark",textTag.className="text-mark",textTag.innerHTML="咨询在线客服",markTag.appendChild(iconTag),markTag.appendChild(textTag),bodyTag.appendChild(markTag),bindEvent({element:markTag,type:"click",callBack:function(e){"1"!==iframeTag.getAttribute("load")?(iframeTag.src=basePath+"roulette/in"+search+"&type=4&rnd="+Math.ceil(1e3*Math.random()),iframeTag.setAttribute("load","1"),iframeTag.onload=function(){loadingWrapper.style.display="none",window.postMessage&&iframeTag.contentWindow.postMessage('{"pageStatus":"1"}',"*")},loadingWrapper.style.display="block"):window.postMessage&&iframeTag.contentWindow.postMessage('{"pageStatus":"1"}',"*"),markTag.style.display="none",wrapperTag.style.display="block",clearAlertMsg()}}),bindEvent({element:window,type:"message",callBack:function(e){if(-1!==basePath.indexOf(e.origin)){var a={};if(a="[object Object]"==Object.prototype.toString.call(e.data)?e.data:JSON.parse(e.data),1==a.type&&(markTag.style.display="block",markTag.style.backgroundColor=a.themeColor,textTag.innerHTML=a.tips),2==a.type&&(markTag.style.display="block",wrapperTag.style.display="none"),3==a.type&&alertMsg(),4==a.type){var t=window.open();myimg=t.document.createElement("img"),myimg.src=a.imgurl,t.document.body.appendChild(myimg)}}}}),window.zhiqiuCount=0,zhiqiu_support||(markTag.style.display="block");